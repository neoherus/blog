<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><link rel="shortcut icon" type="image/x-icon" href="" media="screen"><title>Shadowsocks(R)设置：系统代理模式、PAC、代理规则 - vimcaw的个人博客</title><link rel="stylesheet" href="/blog/css/post-47929d6cf987fbcf21a086632dd14f11.css"><link rel="shortcut icon" href="/blog/image/favicon-d75f01b3d24560fb09e136bdc6e2d396.ico" type="image/vnd.microsoft.icon"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?46649aaca124d5d1bfd6d10d28ddb51d";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115055193-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-115055193-1")</script></head><body><div id="page-top"></div><header id="top"><div class="top-inner"><div class="icon"><a href="/blog/"><img src="/blog/image/icon-0fd3804fbdfc60e0756c074adef5769e.png" alt="">vimcaw的个人博客</a></div><div class="site-nav"><a href="/blog/">首页</a><ul class="site-category-list"><li class="site-category-list-item"><a class="site-category-list-link" href="/blog/categories/C/">C#</a></li><li class="site-category-list-item"><a class="site-category-list-link" href="/blog/categories/Hexo/">Hexo</a></li><li class="site-category-list-item"><a class="site-category-list-link" href="/blog/categories/Web前端/">Web前端</a></li><li class="site-category-list-item"><a class="site-category-list-link" href="/blog/categories/个人项目/">个人项目</a></li><li class="site-category-list-item"><a class="site-category-list-link" href="/blog/categories/软件/">软件</a></li></ul></div></div></header><div class="content"><div class="sidebar"><div class="loader">Loading...</div></div><div class="main"><header>Shadowsocks(R)设置：系统代理模式、PAC、代理规则</header><div class="info"><div class="category"><ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/blog/categories/软件/">软件</a></li></ul></div><ul><li><span class="iconfont icon-publish">发表于 </span><span class="value" title="2018-03-12 20:17:00">2018-03-12</span></li><li><span class="iconfont icon-update">最后更新于 </span><span class="value" title="2018-03-12 22:44:19">2018-03-12</span></li><li id="/blog/2018/03/12/Shadowsocks(R)设置：系统代理模式、PAC、代理规则/" class="iconfont icon-see leancloud_visitors" data-flag-title="Shadowsocks(R)设置：系统代理模式、PAC、代理规则"><span>阅读次数</span> <span class="value"><div class="loader2"></div></span></li><li class="tag"><span class="iconfont icon-tags">标签:</span><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Shadowsocks-R/">Shadowsocks(R)</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/科学上网/">科学上网</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/网络代理软件/">网络代理软件</a></li></ul></li></ul></div><article><p>Shadowsocks(R)控制代理模式的地方主要就是这三个设置：<code>系统代理模式</code>、<code>PAC</code>、<code>代理规则</code>，相信很多人对这三个设置会感到很迷惑，尤其是<code>PAC</code>和<code>代理规则</code>里面相似的选项，那么它们究竟应该怎么设置，又分别实现什么功能呢？<br><a id="more"></a></p><h1 id="系统代理模式"><a href="#系统代理模式" class="headerlink" title="系统代理模式"></a>系统代理模式</h1><p>Shadowssocks(R)右键菜单的第一个选项就是<code>系统代理模式</code>，要想了解它是干什么的，首先要知道什么是<code>系统代理设置</code>。</p><p><code>系统代理设置</code>顾名思义就是Shadowssocks(R)在<code>系统设置</code>里面设置一个<code>代理服务器</code>，让软件可以直接调用<code>系统代理设置</code>直接连接<code>代理服务器</code>，而不需要单独的配置。</p><p>这样所有的软件都可以知道现在有一个<code>代理服务器</code>可以连接，而且只要跟随<code>系统代理设置</code>即可连接，无需额外配置。</p><p>一般而言，只有浏览器（包括内嵌在各种软件中的浏览器，比如 WeGame、优酷、迅雷9等软件中的内嵌浏览器）会自动调用<code>系统代理</code>进行连接。</p><p>而其它大部分应用一般是不会自动启用<code>系统代理</code>进行连接的，要在支持使用代理的软件里面手动设置，<strong> 所以这个选项的设置不会影响到这些软件 </strong>。</p><p>这是因为绝大部分需要进行代理的需求都在浏览器上，其它软件很少有这个需要（如果有的话一般会提供配置和开关给用户）。</p><p>查看系统代理设置：</p><ul><li><p>Win 10：设置 &gt; 网络和 Internet &gt; 代理</p></li><li><p>Win 7：<a href="https://jingyan.baidu.com/article/0aa22375866c8988cc0d648c.html" target="_blank" rel="noopener">windows 7 系统如何设置代理服务器_百度经验</a></p></li></ul><p>所以，<code>系统代理设置</code>控制的就是这个，它有三个选项：</p><h2 id="直连模式"><a href="#直连模式" class="headerlink" title="直连模式"></a>直连模式</h2><p><code>直接模式</code>会在<code>系统代理设置</code>里关闭代理，使启用<code>系统代理设置</code>的软件（一般为浏览器）直接连接网络。</p><p>但是，它并没有关闭在本地构建的<code>代理服务器</code>，其它手动配置代理的软件仍然可以进行连接。</p><h2 id="PAC模式"><a href="#PAC模式" class="headerlink" title="PAC模式"></a>PAC模式</h2><p><code>PAC模式</code>会在<code>系统代理设置</code>设置一个<code>PAC脚本</code>文件，让系统通过这个文件自动选择每一个连接是否启用<code>代理服务器</code>，以及选择哪一个<code>代理服务器</code>。</p><p>详细的<code>PAC</code>介绍见 <a href="#PAC">PAC</a> 一节。</p><p></p><div class="img-center"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/blog/images/system-proxy-pac-6c3d410213c65ef74efabc79a2ca0bd7.png" alt="upload successful"></div><p></p><h2 id="全局模式"><a href="#全局模式" class="headerlink" title="全局模式"></a>全局模式</h2><p><code>全局模式</code>会在<code>系统代理设置</code>手动设置一个<code>代理服务器</code>，所有跟随<code>系统代理设置</code>的软件（一般是浏览器）都会使用这个<code>代理服务器</code>。</p><p></p><div class="img-center"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/blog/images/system-proxy-global-a024c2581408d6db28a3616211338fdf.png" alt="upload successful"></div><p></p><h1 id="PAC"><a href="#PAC" class="headerlink" title="PAC"></a>PAC</h1><p>代理自动配置（英语：Proxy auto-config，简称PAC）是一种网页浏览器技术，用于定义浏览器该如何自动选择适当的代理服务器来访问一个网址。</p><p>一个PAC文件包含一个JavaScript形式的函数“FindProxyForURL(url, host)”。这个函数返回一个包含一个或多个访问规则的字符串。用户代理根据这些规则适用一个特定的代理器或者直接访问。当一个代理服务器无法响应的时候，多个访问规则提供了其他的后备访问方法。浏览器在访问其他页面以前，首先访问这个PAC文件。PAC文件中的URL可能是手工配置的，也可能是是通过网页的网络代理自动发现协议（WPAD）自动配置的。</p><p>简单来说，<code>PAC</code>是一种自动选择每一个连接是否使用<code>代理服务器</code>，以及选用哪一个<code>代理服务器</code>的技术，而自动选择是通过一个<code>JavaScript</code>脚本文件实现的，这个脚本文件制定了一系列的规则进行判断。</p><p>我们选择在<code>系统代理模式</code>中选择<code>PAC模式</code>后，<code>PAC</code>才会生效。</p><p>在系统设置里面可以看到<code>PAC</code>脚本地址：</p><p></p><div class="img-center"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/blog/images/system-proxy-pac-6c3d410213c65ef74efabc79a2ca0bd7.png" alt="upload successful"></div><p></p><p>复制地址在浏览器打开后可以下载<code>PAC</code>脚本文件，这个文件很大，这里我列出部分内容：<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> direct = <span class="hljs-string">"DIRECT;"</span>;<br><span class="hljs-keyword">if</span> (direct == <span class="hljs-string">"__DIR"</span> + <span class="hljs-string">"ECT__"</span>) direct = <span class="hljs-string">"DIRECT;"</span>;<br><br><span class="hljs-keyword">var</span> wall_proxy = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"PROXY 127.0.0.1:1080;DIRECT;"</span>; &#125;;<br><span class="hljs-keyword">var</span> wall_v6_proxy = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"PROXY 127.0.0.1:1080;DIRECT;"</span>; &#125;;<br><br>...<br>...<br>...<br><br>function FindProxyForURL(url, host) &#123;<br>	<span class="hljs-keyword">if</span> ( isPlainHostName(host) === <span class="hljs-literal">true</span> ) &#123;<br>		<span class="hljs-keyword">return</span> direct;<br>	&#125;<br>	<span class="hljs-keyword">if</span> (defaultMatcher.matchesAny(url, host) <span class="hljs-keyword">instanceof</span> BlockingFilter) &#123;<br>		<span class="hljs-keyword">return</span> wall_proxy();<br>	&#125;<br>	<span class="hljs-keyword">if</span> ( check_ipv4(host) === <span class="hljs-literal">true</span> ) &#123;<br>		<span class="hljs-keyword">return</span> getProxyFromIP(host);<br>	&#125;<br>	<span class="hljs-keyword">return</span> direct;<br>&#125;<br></code></pre></td></tr></table></figure><p></p><p>这个也就是Shadowsocks(R)文件夹下的<code>pac.txt</code>文件的内容。</p><p>Shadowsocks(R)右键菜单的<code>PAC</code>选项可以更新<code>PAC文件</code>为各种规则，但是貌似不能自动更新，可以定期手动更新下来获取最新的<code>PAC文件</code>规则。</p><h1 id="代理规则"><a href="#代理规则" class="headerlink" title="代理规则"></a>代理规则</h1><p>Shadowsocks(R)会在用户的电脑上构建一个本地<code>Socks5代理</code>，<code>代理规则</code>选项是对所有连接了这个代理的网路请求进行判断，根据不同的判断依据选择是否进行代理。所以，<code>代理规则</code>选项是控制是否进行代理的最终开关。</p><p><code>代理规则</code>选项通过域名的<code>IP地址</code>来判断是否某个域名是否来自<code>大陆</code>，也可以通过自定义规则来判断。</p><h1 id="代理流程图"><a href="#代理流程图" class="headerlink" title="代理流程图"></a>代理流程图</h1><p>参考网络上的资料，我画了一张Shadowsocks(R)代理流程图：</p><p></p><div class="img-center"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/blog/images/SSR代理流程-fe8afee3da0984508d085942bda02c7d.png" alt="upload successful"></div><p></p><p>通过流程图可以看出，如果<code>系统代理模式</code>设置了<code>PAC模式</code>，浏览器等通过<code>系统代理设置</code>进行连接的软件要通过<code>PAC</code>、<code>代理规则</code>两层判断，而剩余情况只需通过<code>代理规则</code>这一层判断。</p><blockquote><p>参考资料：</p><ol><li><a href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%90%86%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE" target="_blank" rel="noopener">代理自动配置 - 维基百科，自由的百科全书</a></li><li><a href="https://doub.io/ss-jc10/" target="_blank" rel="noopener">ShadowsocksR 客户端 小白使用教程 | 逗比根据地</a></li></ol></blockquote></article><div class="end"><span>The End</span></div><div class="copyright-announce"><p>© 本文著作权归 <a target="_blank" rel="external nofollow" href="https://github.com/vimcaw">vimcaw</a> 所有，未经许可，不得转载使用。</p></div><div class="recommended_posts"><h1>推荐文章</h1><ul><li><a href="https://vimcaw.github.io/blog/2018/03/12/如何用Shadowsocks(R)代理非浏览器软件、游戏/">如何用Shadowsocks(R)代理非浏览器软件、游戏</a></li><li><a href="https://vimcaw.github.io/blog/2018/03/11/Shadowsocks(R)基本原理/">Shadowsocks(R)基本原理</a></li><li><a href="https://vimcaw.github.io/blog/2018/03/08/CSS水平垂直都居中方法及其兼容性大汇总/">CSS水平垂直都居中方法及其兼容性大汇总</a></li><li><a href="https://vimcaw.github.io/blog/2018/03/08/CSS垂直居中方法及其兼容性大汇总/">CSS垂直居中方法及其兼容性大汇总</a></li></ul><p>Powered by <a target="_blank" href="https://github.com/huiwang/hexo-recommended-posts">hexo文章推荐插件</a></p></div><div id="comment"><div id="lv-container" data-id="city" data-uid="MTAyMC8zNDA4MS8xMDYxOQ=="><script type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&((n=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script><noscript>为正常使用来必力评论功能请激活JavaScript</noscript></div></div></div><div id="nav" class="iconfont icon-menu circle-button"></div><div class="shade"></div><a href="#page-top" data-scroll id="back-to-top" class="iconfont icon-top circle-button"></a><div id="image-view" class="hidden"><img src="" alt=""></div></div><footer><ul class="social"><li><a href="https://github.com/vimcaw" title="GitHub账号：https://github.com/vimcaw" class="iconfont icon-githublogo"></a></li><li><a href="mailto:vimcaw@gmail.com" title="Email: vimcaw@gmail.com" class="iconfont icon-icon-email"></a></li><li><a href="https://www.zhihu.com/people/zhu-chang-sheng-87/" title="知乎账号: https://www.zhihu.com/people/zhu-chang-sheng-87/" class="iconfont icon-zhihu0"></a></li></ul><div class="copyright"><p>Copyright © <span id="current-year">current</span> <a href="https://github.com/vimcaw"><span>vimcaw</span></a></p></div><div class="powered-by"><p>Powered by <a href="https://hexo.io/">Hexo</a></p></div><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量 <span id="busuanzi_value_site_pv">-</span> 次</span></footer><script>document.getElementById("current-year").innerText=(new Date).getFullYear()</script><script src="/blog/js/post-a30c1aebae8b542470fb71010e2b9200.js"></script><script src="https://unpkg.com/tippy.js@2.2.3/dist/tippy.all.min.js"></script><script>tippy(".value",{arrow:!0,size:"normal"})</script><script src="//cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("Aseal9CayMnDRtxbViPlJbWg-gzGzoHsz","V0Eggyhl9pIzMjNrHGKLwiGf")</script><script src="/blog/js/later-b8275a8c6b88fe7778874166d8d010bd.js"></script><script>!function(t){var e=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function n(t,e){var n=new Image,i=t.getAttribute("data-original");n.onload=function(){t.src=i,e&&e()},n.src=i}function i(){for(var i=0;i<e.length;i++)(o=e[i].getBoundingClientRect()).top>=0&&o.left>=0&&o.top<=(t.innerHeight||document.documentElement.clientHeight)&&n(e[i],function(){e.splice(i,i)});var o}i(),t.addEventListener("scroll",i)}(this)</script></body></html>